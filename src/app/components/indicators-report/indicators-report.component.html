<div class="row">
    <div class="header-row col-sm-12 col-md-12" style="display: flex; flex-wrap: wrap; justify-content: flex-end;">
        <button class="buttons-options" mat-menu-item>
            <mat-icon>paid</mat-icon>
            <span>Presupuestos</span>
        </button>
        <button class="buttons-options" mat-menu-item>
            <mat-icon>stream</mat-icon>
            <span>Interrelaciones</span>
        </button>
        <button class="buttons-options" mat-menu-item>
            <mat-icon>alt_route</mat-icon>
            <span>Causales de desviación</span>
        </button>
    </div>
</div>

<mat-tab-group (selectedTabChange)="tabChanged($event)">
    <mat-tab label="Indicadores Portafolio de Proyectos">
        <br>
        <mat-accordion>
            <mat-expansion-panel class="row mat-elevation-z0 card-expansion"
                [expanded]="step === 0" (opened)="openStates(0)">

                <mat-expansion-panel-header class="col-sm-12 col-md-12">
                    <mat-panel-title class="col-sm-12 col-md-5">
                        <h3 class="txt-primary title-expansion ">Estados</h3>
                    </mat-panel-title>
                    <mat-panel-description class="col-sm-12 col-md-7 description">Proyectos por estados y vicepresidencias</mat-panel-description>
                </mat-expansion-panel-header>
                <br>
                <tecno-dynamic-table
                    [objectsData]="statesByVicepresidenciesTable"
                    emptyText="Ingrese datos">
                </tecno-dynamic-table>
                <mat-action-row>
                    <button mat-button color="primary" (click)="nextStep()">{{labelStep.next}}</button>
                </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="row mat-elevation-z0 card-expansion"
                [expanded]="step === 1" (opened)="openTypifications(1)">

                <mat-expansion-panel-header class="col-sm-12 col-md-12">
                    <mat-panel-title class="col-sm-12 col-md-5">
                        <h3 class="txt-primary title-expansion ">Tipificación</h3>
                    </mat-panel-title>
                    <mat-panel-description class="col-sm-12 col-md-7 description">Proyectos por tipificación y vicepresidencias</mat-panel-description>
                </mat-expansion-panel-header>
                <br>
                <tecno-dynamic-table
                    [objectsData]="typificationsByVicepresidencies"
                    emptyText="Ingrese datos">
                </tecno-dynamic-table>
                
                <mat-action-row>
                    <button mat-button color="warn" (click)="prevStep()">{{labelStep.back}}</button>
                    <button mat-button color="primary" (click)="nextStep()">{{labelStep.next}}</button>
                </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="row mat-elevation-z0 card-expansion"
                [expanded]="step === 2" (opened)="openPriorities(2)">

                <mat-expansion-panel-header class="col-sm-12 col-md-12">
                    <mat-panel-title class="col-sm-12 col-md-5">
                        <h3 class="txt-primary title-expansion ">Prioridad</h3>
                    </mat-panel-title>
                    <mat-panel-description class="col-sm-12 col-md-7 description">Proyectos por prioridad y vicepresidencias</mat-panel-description>
                </mat-expansion-panel-header>
                <div class="row">
                    <div *ngIf="!emptyGraphPriorities" class="col-sm-12 col-md-6 graph">
                        <tecno-pie-charts
                            [id]="'1'"
                            [title]="'Prioridad'"
                            [pieHole]="0.6"
                            [dataTable]="dataGraphicPriorities">
                        </tecno-pie-charts>
                    </div>
                    <div class="col-sm-12 col-md-6 table">
                        <tecno-dynamic-table
                            [objectsData]="priorities"
                            emptyText="Ingrese datos">
                        </tecno-dynamic-table>
                    </div>
                </div>
                <mat-action-row>
                    <button mat-button color="warn" (click)="prevStep()">{{labelStep.back}}</button>
                    <button mat-button color="primary" (click)="nextStep()">{{labelStep.next}}</button>
                </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="row mat-elevation-z0 card-expansion"
                [expanded]="step === 3" (opened)="setStep(3)">
                <mat-expansion-panel-header class="col-sm-12 col-md-12">
                    <mat-panel-title class="col-sm-12 col-md-5">
                        <h3 class="txt-primary title-expansion ">Avance</h3>
                    </mat-panel-title>
                    <mat-panel-description class="col-sm-12 col-md-7 description">Proyectos avance</mat-panel-description>
                </mat-expansion-panel-header>
                    
                <mat-action-row>
                    <button mat-button color="warn" (click)="prevStep()">{{labelStep.back}}</button>
                    <button mat-button color="primary" (click)="nextStep()">{{labelStep.next}}</button>
                </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="row mat-elevation-z0 card-expansion"
                [expanded]="step === 4" (opened)="setStep(4)">

                <mat-expansion-panel-header class="col-sm-12 col-md-12">
                    <mat-panel-title class="col-sm-12 col-md-5">
                        <h3 class="txt-primary title-expansion ">Áreas</h3>
                    </mat-panel-title>
                    <mat-panel-description class="col-sm-12 col-md-7 description">Proyectos por áreas y vicepresidencias</mat-panel-description>
                </mat-expansion-panel-header>
                <mat-action-row>
                    <button mat-button color="warn" (click)="prevStep()">{{labelStep.back}}</button>
                    <button mat-button color="primary" (click)="nextStep()">{{labelStep.next}}</button>
                </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="row mat-elevation-z0 card-expansion"
                [expanded]="step === 5" (opened)="openPrograms(5)">

                <mat-expansion-panel-header class="col-sm-12 col-md-12">
                    <mat-panel-title class="col-sm-12 col-md-5">
                        <h3 class="txt-primary title-expansion ">Programas</h3>
                    </mat-panel-title>
                    <mat-panel-description class="col-sm-12 col-md-7 description">Proyectos por áreas y vicepresidencias</mat-panel-description>
                </mat-expansion-panel-header>
                
                <mat-accordion>
                    <mat-expansion-panel *ngFor="let program of programs" class="row mat-elevation-z1 card-expansion" >
                        <mat-expansion-panel-header class="col-sm-12 col-md-12" style="padding-left: 60px; padding-right: 60px;">
                            <mat-panel-title class="col-sm-12 col-md-2">
                                <h3 class="title-expansion">{{program.name}}</h3>
                            </mat-panel-title>
                            <mat-panel-description class="col-sm-12 col-md-10 description" style="display: flex; justify-content: space-between;">
                                <span>Avance Esperado: {{program.advance_spected}}</span>
                                <span>Avance Real: {{program.advance_real}}</span>
                                <span class="indicator-container">
                                    <span>Desviación: {{program.desviation.value}}</span>
                                    <div class="circle" [ngStyle]="{'background-color': program.desviation.color}"></div>
                                </span>
                            </mat-panel-description>
                        </mat-expansion-panel-header>
                        
                        <mat-accordion>
                            <mat-expansion-panel *ngFor="let vp of program.vicepresidencies" class="row mat-elevation-z1 card-expansion">
                                <mat-expansion-panel-header class="col-sm-12 col-md-12">
                                    <mat-panel-title class="col-sm-12 col-md-2">
                                        <h3 class="title-expansion" style="color: #5C6BC0;">{{vp.name}}</h3>
                                    </mat-panel-title>
                                    <mat-panel-description class="col-sm-12 col-md-10 description" style="display: flex; justify-content: space-between;">
                                        <span>Avance Esperado: {{vp.advance_spected}}</span>
                                        <span>Avance Real: {{vp.advance_real}}</span>
                                        <span class="indicator-container">
                                            <span>Desviación: {{vp.desviation.value}}</span>
                                            <div class="circle" [ngStyle]="{'background-color': vp.desviation.color}"></div>
                                        </span>
                                    </mat-panel-description>
                                </mat-expansion-panel-header>

                                <tecno-dynamic-table
                                    [objectsData]="vp.tableData"
                                    elevation="mat-elevation-z1"
                                    emptyText="Ingrese datos">
                                </tecno-dynamic-table>
                            </mat-expansion-panel>
                        </mat-accordion>
                    </mat-expansion-panel>
                </mat-accordion>

                <mat-action-row>
                    <button mat-button color="warn" (click)="prevStep()">{{labelStep.back}}</button>
                </mat-action-row>
            </mat-expansion-panel>
            </mat-accordion>
    </mat-tab>

    <mat-tab label="Indicadores Proovedores">
        <br>
        <div class="row" style="width: 100%">
            <div *ngIf="!emptyGraphCompanies && indexTab==1" class="col-sm-12 col-md-6 graph">
                <tecno-column-charts
                    [id]="'3'"
                    [dataTable]="dataGraphicCompanies"
                    width="100%"
                    height="100%"
                    bars="horizontal">
                </tecno-column-charts>
            </div>
            <div class="col-sm-12 col-md-6 table" style="padding-bottom: 20px;">
                <tecno-dynamic-table
                    [objectsData]="companies"
                    emptyText="Ingrese datos">
                </tecno-dynamic-table>
            </div>
        </div>
    </mat-tab>

    <mat-tab label="Indicadores Gerentes de Proyectos">
    </mat-tab>
</mat-tab-group>
